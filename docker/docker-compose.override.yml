
# Development override for docker-compose
#
# Purpose:
#  - Provide developer-friendly overrides for the main `docker-compose.yml`.
#  - This file is automatically picked up by `docker compose` when present
#    (no extra flags needed) and merges with the main compose file.
#
# Typical use in this project:
#  - Avoid binding the Postgres container to host port 5432 to prevent
#    conflicts with a host Postgres instance (`5433:5432` instead).
#  - Expose backend, frontend and adminer ports to the host for local
#    development and debugging.
#
# Use: keep this file for local development. It is NOT required for
# production and should not be used on production hosts.

services:
  db:
    # Host port for Postgres can be overridden with POSTGRES_HOST_PORT
    # Example: POSTGRES_HOST_PORT=5433 docker compose up -d
    ports:
      - "${POSTGRES_HOST_PORT:-5434}:5432"
  backend:
    ports:
      - "8000:8000"
  frontend:
    build:
      args:
        - VITE_API_URL=http://localhost:8000
    ports:
      - "5173:80"

  # pgAdmin - PostgreSQL administration tool
  # Access: http://localhost:5051
  # Login: admin@hear-ui.local / admin (change in production!)
  pgadmin:
    image: dpage/pgadmin4:latest
    restart: always
    ports:
      - "5051:80"
    environment:
      PGADMIN_DEFAULT_EMAIL: admin@example.com
      PGADMIN_DEFAULT_PASSWORD: admin
      PGADMIN_CONFIG_SERVER_MODE: 'False'
      PGADMIN_CONFIG_MASTER_PASSWORD_REQUIRED: 'False'
    volumes:
      - pgadmin-data:/var/lib/pgadmin
    depends_on:
      - db

volumes:
  pgadmin-data: