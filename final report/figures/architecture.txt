┌─────────────────────────────────────────────────────────────────────────┐
│                           HEAR-UI System Architecture                   │
│                         (Cochlear Implant Prediction)                   │
└─────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────┐
│                              CLIENT LAYER                                │
└──────────────────────────────────────────────────────────────────────────┘
                                     │
                                     │ HTTP/REST
                                     ▼
┌──────────────────────────────────────────────────────────────────────────┐
│                         FRONTEND APPLICATION                             │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  Vue.js 3.5.13 + TypeScript 5.6.3 + Vuetify 3.7.5              │   │
│  │  Port: 5173 (dev) / 80 (prod)                                   │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                          │
│  Components:                                                             │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌────────────┐ │
│  │   Patient    │  │  Prediction  │  │     SHAP     │  │  Feedback  │ │
│  │ Management   │  │  Interface   │  │Visualization │  │   Form     │ │
│  └──────────────┘  └──────────────┘  └──────────────┘  └────────────┘ │
└──────────────────────────────────────────────────────────────────────────┘
                                     │
                            HTTP REST API (JSON)
                                     ▼
┌──────────────────────────────────────────────────────────────────────────┐
│                          BACKEND APPLICATION                             │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  FastAPI 0.115.5 + Python 3.12                                  │   │
│  │  Port: 8000                                                      │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                          │
│  API Routes (17 endpoints):                                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌────────────┐ │
│  │ /api/v1/     │  │ /api/v1/     │  │ /api/v1/     │  │ /api/v1/   │ │
│  │ predict      │  │ explainer    │  │ patients     │  │ feedback   │ │
│  │ (POST)       │  │ (POST/GET)   │  │ (CRUD)       │  │ (POST)     │ │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └────┬───────┘ │
│         │                 │                 │                │         │
│         ▼                 ▼                 ▼                ▼         │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │                      CORE BUSINESS LOGIC                         │  │
│  │  ┌────────────────┐  ┌────────────────┐  ┌───────────────────┐ │  │
│  │  │ Model Wrapper  │  │ SHAP Explainer │  │  Preprocessor     │ │  │
│  │  │                │  │                │  │                   │ │  │
│  │  │ LogReg (68F)   │◄─┤ LinearExplain  │◄─┤ CSV → numpy      │ │  │
│  │  │ scikit-learn   │  │ TreeExplain    │  │ OneHotEncoder    │ │  │
│  │  │ 1.5.2          │  │ SHAP 0.46.0    │  │ StandardScaler   │ │  │
│  │  └────────┬───────┘  └────────────────┘  └───────────────────┘ │  │
│  │           │                                                      │  │
│  │           │  logreg_best_pipeline.pkl                           │  │
│  │           ▼                                                      │  │
│  │  ┌────────────────────────────────────────┐                     │  │
│  │  │  Predictions:                          │                     │  │
│  │  │  - Success Probability (0-100%)        │                     │  │
│  │  │  - SHAP Values (feature importance)    │                     │  │
│  │  │  - Top Contributing Features           │                     │  │
│  │  └────────────────────────────────────────┘                     │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                  │                                      │
│                                  │ SQLModel/SQLAlchemy                  │
│                                  ▼                                      │
└──────────────────────────────────────────────────────────────────────────┘
                                     │
┌──────────────────────────────────────────────────────────────────────────┐
│                         DATABASE LAYER                                   │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  PostgreSQL 12                                                   │   │
│  │  Port: 5434                                                      │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                          │
│  Tables:                                                                 │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌────────────┐ │
│  │   patients   │  │ predictions  │  │   feedback   │  │  users     │ │
│  │              │  │              │  │              │  │            │ │
│  │ id (PK)      │  │ id (PK)      │  │ id (PK)      │  │ id (PK)    │ │
│  │ display_name │  │ patient_id   │  │ prediction_id│  │ email      │ │
│  │ age          │  │ prediction   │  │ rating       │  │ password   │ │
│  │ gender       │  │ timestamp    │  │ comment      │  │ is_active  │ │
│  │ ... (68 feat)│  │ shap_values  │  │ timestamp    │  │            │ │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └────────────┘ │
│         │                 │                 │                           │
│         └─────────────────┴─────────────────┘                           │
│                           │                                              │
│                  Foreign Key Relationships                               │
└──────────────────────────────────────────────────────────────────────────┘
                                     │
                            Alembic Migrations
                                     ▼
┌──────────────────────────────────────────────────────────────────────────┐
│                      DEVELOPMENT & TESTING TOOLS                         │
└──────────────────────────────────────────────────────────────────────────┘
│
│  Testing Infrastructure:
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌────────────┐
│  │   pytest     │  │ pytest-cov   │  │  Playwright  │  │   Ruff     │
│  │  268 tests   │  │ 72% coverage │  │  18 E2E tests│  │  Linter    │
│  └──────────────┘  └──────────────┘  └──────────────┘  └────────────┘
│
│  CI/CD Pipeline (GitHub Actions):
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌────────────┐
│  │   Linting    │  │ Unit Tests   │  │  E2E Tests   │  │  Coverage  │
│  │   (Ruff)     │  │  (pytest)    │  │ (Playwright) │  │  Reports   │
│  └──────────────┘  └──────────────┘  └──────────────┘  └────────────┘
│
│  Database Management:
│  ┌──────────────┐  ┌──────────────┐
│  │   pgAdmin    │  │   Alembic    │
│  │  Port: 5051  │  │  Migrations  │
│  └──────────────┘  └──────────────┘
│
└──────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────┐
│                        DEPLOYMENT & INFRASTRUCTURE                       │
└──────────────────────────────────────────────────────────────────────────┘
│
│  Docker Compose Orchestration:
│  ┌────────────────────────────────────────────────────────────────────┐
│  │  Services:                                                         │
│  │  • backend     (FastAPI)                                           │
│  │  • frontend    (Vue.js + nginx)                                    │
│  │  • db          (PostgreSQL 12)                                     │
│  │  • pgadmin     (Database Management)                               │
│  │                                                                    │
│  │  Networks:                                                         │
│  │  • hear-ui-network (bridge)                                        │
│  │                                                                    │
│  │  Volumes:                                                          │
│  │  • postgres_data (persistent storage)                             │
│  └────────────────────────────────────────────────────────────────────┘
│
│  Environment Configuration:
│  ┌────────────────────────────────────────────────────────────────────┐
│  │  .env Variables:                                                   │
│  │  • DATABASE_URL                                                    │
│  │  • MODEL_PATH                                                      │
│  │  • SECRET_KEY                                                      │
│  │  • POSTGRES_PASSWORD                                               │
│  └────────────────────────────────────────────────────────────────────┘
│
└──────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────┐
│                           DATA FLOW EXAMPLE                              │
└──────────────────────────────────────────────────────────────────────────┘

 1. User enters patient data in Vue.js frontend
                    │
                    ▼
 2. POST /api/v1/predict with JSON payload
                    │
                    ▼
 3. FastAPI preprocessor converts CSV format → numpy array
                    │
                    ▼
 4. Model wrapper loads pipeline and generates prediction
                    │
                    ▼
 5. SHAP explainer computes feature importance
                    │
                    ▼
 6. Response: {prediction: 0.97, shap_values: [...]}
                    │
                    ▼
 7. Frontend displays prediction + SHAP bar chart
                    │
                    ▼
 8. User submits feedback (agree/disagree)
                    │
                    ▼
 9. POST /api/v1/feedback saves to PostgreSQL
                    │
                    ▼
10. Analytics: Model performance tracking

┌──────────────────────────────────────────────────────────────────────────┐
│                          KEY PERFORMANCE METRICS                         │
└──────────────────────────────────────────────────────────────────────────┘

• Prediction Latency:     < 200ms (avg 150ms)
• SHAP Explanation:       < 500ms (avg 350ms)
• Database Query:         < 50ms
• API Throughput:         100+ req/s (async FastAPI)
• Test Coverage:          72% (production code)
• Test Suite Runtime:     ~45 seconds (268 tests)
• Docker Build Time:      ~3 minutes (multi-stage)
• Model Size:             ~500KB (serialized pipeline)
• Feature Dimensions:     68 features (after preprocessing)
• Database Size:          ~10MB (5 test patients)

┌──────────────────────────────────────────────────────────────────────────┐
│                          SECURITY FEATURES                               │
└──────────────────────────────────────────────────────────────────────────┘

• Password Hashing:       bcrypt (OWASP recommended)
• JWT Authentication:     HS256 algorithm, 30-min expiry
• Input Validation:       Pydantic schemas, strict typing
• SQL Injection:          Protected via SQLModel ORM
• CORS Configuration:     Explicit origin whitelisting
• Environment Secrets:    .env file (not in git)
• HTTPS Support:          nginx reverse proxy ready

┌──────────────────────────────────────────────────────────────────────────┐
│                            TECHNOLOGY STACK                              │
└──────────────────────────────────────────────────────────────────────────┘

Backend:           Python 3.12, FastAPI 0.115.5, SQLModel 0.0.22
Frontend:          TypeScript 5.6.3, Vue.js 3.5.13, Vuetify 3.7.5
Database:          PostgreSQL 12, Alembic 1.14.0
ML Framework:      scikit-learn 1.5.2, SHAP 0.46.0, pandas 2.2.3
Testing:           pytest 8.3.4, Playwright 1.48.2, pytest-cov 6.0.0
Build Tools:       Vite 6.0.1, Docker Compose, pnpm 9.15.0
CI/CD:             GitHub Actions (7 workflows)
Code Quality:      Ruff (Python), Biome (TypeScript), pre-commit hooks

┌──────────────────────────────────────────────────────────────────────────┐
│                          PROJECT STATISTICS                              │
└──────────────────────────────────────────────────────────────────────────┘

• Git Commits:            80+ (Oct 2025 - Dec 2025)
• Contributors:           3 (Adelia, Artem, Niels)
• Lines of Code:          ~15,000 (excluding tests)
• Test Files:             43 (backend) + 18 (E2E)
• Documentation Pages:    8 (README, PROJECT_HISTORY, REFERENCES, etc.)
• API Endpoints:          17 (RESTful)
• Database Migrations:    12 (Alembic revisions)
• Docker Containers:      4 (backend, frontend, db, pgadmin)
• GitHub Actions:         7 (CI/CD workflows)
• Sprint Iterations:      5 (MS1, MS2, MS3)

Legend:
─────  Data flow
│      Vertical connection
▼      Direction of flow
◄      Bidirectional connection
PK     Primary Key
FK     Foreign Key
CRUD   Create, Read, Update, Delete
E2E    End-to-End
CI/CD  Continuous Integration/Continuous Deployment
